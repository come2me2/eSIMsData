# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞

–î–∞–Ω–Ω—ã–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 1 —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ —á–µ—Ä–µ–∑ cron job. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤—Å–µ–≥–¥–∞ –≤–∏–¥—è—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—ç—à–∞

–ü–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π cron job —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫—ç—à –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ä–∞–∑—É –≤–∏–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–µ.

### –ù–∞ Vercel:

–í—ã–∑–æ–≤–∏—Ç–µ endpoint —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ curl:

```bash
curl -X POST "https://your-domain.vercel.app/api/cache/prefill?secret=YOUR_SECRET"
```

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://your-domain.vercel.app/api/cache/prefill?secret=YOUR_SECRET
```

**–í–∞–∂–Ω–æ**: –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_SECRET` –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `CACHE_REFRESH_SECRET` –∏–∑ Vercel.

### –ù–∞ Contabo VPS:

```bash
cd /var/www/esimsdata
npm run prefill-cache
```

–ò–ª–∏ —á–µ—Ä–µ–∑ HTTP endpoint:
```bash
curl -X POST "http://localhost:3000/api/cache/prefill?secret=YOUR_SECRET"
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∏—Ç –∏ –∑–∞–∫—ç—à–∏—Ä—É–µ—Ç:
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω
- ‚úÖ Global –ø–ª–∞–Ω—ã (standard –∏ unlimited)
- ‚úÖ Region –ø–ª–∞–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ (Africa, Asia, Europe, –∏ —Ç.–¥.)
- ‚úÖ Local –ø–ª–∞–Ω—ã –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å—Ç—Ä–∞–Ω (US, GB, DE, FR, –∏ —Ç.–¥.)

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~2-5 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ API

## –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel Cron Jobs (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å Pro –ø–ª–∞–Ω)

Vercel Cron Jobs –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ Pro –ø–ª–∞–Ω–µ –∏ –≤—ã—à–µ. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `vercel.json`:

```json
{
  "crons": [
    {
      "path": "/api/cache/refresh?secret=YOUR_SECRET&type=all",
      "schedule": "0 2 * * *"
    }
  ]
}
```

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ**: `0 2 * * *` –æ–∑–Ω–∞—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00 UTC.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞**:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `CACHE_REFRESH_SECRET` –≤ Vercel (Settings ‚Üí Environment Variables)
2. –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_SECRET` –≤ `vercel.json` –Ω–∞ —Ç–æ—Ç –∂–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
3. –î–µ–ø–ª–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ Vercel

## –í–∞—Ä–∏–∞–Ω—Ç 2: –í–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (–¥–ª—è Hobby –ø–ª–∞–Ω–∞)

–ï—Å–ª–∏ —É –≤–∞—Å Hobby –ø–ª–∞–Ω Vercel, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è cron jobs:

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cron-job.org (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://cron-job.org
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π cron job:
   - **URL**: `https://your-domain.vercel.app/api/cache/refresh?secret=YOUR_SECRET&type=all`
   - **Schedule**: `0 2 * * *` (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00 UTC)
   - **Method**: GET –∏–ª–∏ POST
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `CACHE_REFRESH_SECRET` –≤ Vercel
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ URL

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ EasyCron

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://www.easycron.com
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π cron job —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GitHub Actions (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.github/workflows/refresh-cache.yml`:

```yaml
name: Refresh Cache

on:
  schedule:
    - cron: '0 2 * * *'  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00 UTC
  workflow_dispatch:  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

jobs:
  refresh:
    runs-on: ubuntu-latest
    steps:
      - name: Refresh Cache
        run: |
          curl -X POST "https://your-domain.vercel.app/api/cache/refresh?secret=${{ secrets.CACHE_REFRESH_SECRET }}&type=all"
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞**:
1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç `CACHE_REFRESH_SECRET` –≤ GitHub (Settings ‚Üí Secrets ‚Üí Actions)
2. –ó–∞–º–µ–Ω–∏—Ç–µ `your-domain.vercel.app` –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ—Ç –∂–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ Vercel

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∏–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `CACHE_REFRESH_SECRET` –≤ Vercel. –≠—Ç–æ –∑–∞—â–∏—Ç–∏—Ç endpoint –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cron job, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –≤ —Ä–∞–∑–¥–µ–ª–µ Functions. –í—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –ª–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é:
```bash
curl -X POST "https://your-domain.vercel.app/api/cache/refresh?secret=YOUR_SECRET&type=all"
```

## TTL –∫—ç—à–∞

TTL (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏) –∫—ç—à–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 24 —á–∞—Å–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 24 —á–∞—Å–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ cron job
- –ï—Å–ª–∏ cron job –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –¥–∞–Ω–Ω—ã–µ –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ (–Ω–æ —ç—Ç–æ –∑–∞–π–º–µ—Ç –≤—Ä–µ–º—è)

